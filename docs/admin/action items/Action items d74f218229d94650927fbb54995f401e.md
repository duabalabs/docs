# Action items

## How to set up Digital Ocean droplet

### Create a DigitalOcean Account

1. Go to [DigitalOcean](https://www.digitalocean.com/) and sign up
2. Verify your account and log in to your dashboard

### Create Droplets

1. Click up on the ‚ÄúCreate Droplet‚Äù button in your dashboard
2. For each droplet: 
a. Choose an operating system for a Virtual Machine. Select Ubuntu 22.04(LTS)(easier to use and widely supported)
    1. Choose a plan:
    a. For OmniLeads: Choose a droplet with 4GB RAM, 2vCPUs, 80GB SSD
    b. For Odoo: Choose a droplet with 2GB RAM, 1vCPU,
    c. For the database server(which will host the PostgreSQL) for Odoo, choose a droplet with RAM 4GB, 2vCPU, at least 50GB SSD
3. Choose a datacenter region close to your region.
- For Ghana, the data center close is Amsterdam(AMS) or Frankfurt(FRA). 
- **Amsterdam (AMS3)**: This data center is geographically closer and typically provides lower latency for West African countries, including Ghana.
- **Frankfurt (FRA1)**: Also a good option, as it is a bit more central in Europe and offers strong network infrastructure.

       But recommended: Amsterdam(AMS3)

1. Authentication: Recommended- SSH keys(can also use password authentication). If choose SSH, generate and upload your SSH key
2. Name your droplet something cool and nice and click on Create Droplet

### Access Droplet

1. After the droplet has been created, use an SSH client to connect. That is open terminal (on Linux or Mac) or use a program like PuTTY on Windows

```bash
ssh root@<DROPLET_IP_ADDRESS>
# Replace <DROPLET_IP_ADDRESS> with the actual IP address of your droplet)
```

### Update all droplets

1. Update droplet to make it ready to install software

```bash
sudo apt update && sudo apt upgrade -y
```

2. Create a new user and disable root login:

```bash
adduser callcenteradmin
usermod -aG sudo callcenteradmin
```

Disable root login in the  `/etc/ssh/sshd_config` file

```bash
PermitRootLogin no
```

3. Install necessary dependencies

```bash
sudo apt install curl git ufw
```

## Software and dependencies

1. Install dependencies
- Connect to your OmniLeads droplet and install the necessary software dependencies

```bash
sudo apt install -y curl wget git python3 python3-pip postgresql postgresql-contrib nginx redis
```

1. Install Docker
- OmniLeads runs in Docker hence Docker and Docker Compose must be installed

```bash
sudo apt install -y docker.io docker-compose
```

1. Start and enable Docker

```bash
sudo systemctl start docker
sudo systemctl enable docker
```

1. Download and install OmniLeads

```bash
git clone https://github.com/Issabel-Foundation/omni_leads.git /opt/omni_leads
```

1. Navigate to the OmniLeads directory and set up the system:

```bash
cd /opt/omni_leads
docker-compose up -d
```

This command will pull the required images and set up OmniLeads inside Docker containers 

### Install and configure Odoo(CRM/ERM)

1. Install Odoo‚Äôs database, PostgreSQL

```bash
sudo apt install postgresql postgresql-contrib -y
```

1. Set up PostgreSQL to allow Odoo to connect:

```bash
sudo -u postgres createuser -s odoo
sudo -u postgres createdb odoo_db
```

3. Install the dependencies for Odoo:

```bash
sudo apt install git python3-dev python3-pip build-essential wget python3-venv python3-wheel libpq-dev -y
```

4. Clone the Odoo source code

```bash
sudo git clone https://www.github.com/odoo/odoo --depth 1 --branch 16.0 /opt/odoo
```

5. Install Python dependencies

```bash
cd /opt/odoo
sudo pip3 install -r requirements.txt
```

6. Create a systemd file for Odoo:

```bash
sudo nano /etc/systemd/system/odoo.service
```

7. Insert the following configurations

```
[Unit]
Description=Odoo
Documentation=http://www.odoo.com

[Service]
# Edit ExecStart with your installation path
ExecStart=/usr/bin/python3 /opt/odoo/odoo-bin -c /etc/odoo.conf

[Install]
WantedBy=multi-user.target
```

8. Start and enable Odoo

```bash
sudo systemctl enable odoo
sudo systemctl start odoo
```

  

## Twilio integration(SIP Trunking)

### Set up Twilio SIP Trunk

1. Sign up or log in to [Twilio SIP Trunking](https://www.twilio.com/en-us/sip-trunking)
2. Navigate to Elastic SIP Trunks in the Twilio console and create a new trunk
3. Click on Get Started and then click on ‚ÄúCreate  a SIP Trunk‚Äù
4. Name the SIP Trunk a friendly name üòâ
5.  Set your Termination SIP URI to point to the public IP of your OmniLeads droplet(  `sip: <YOUR_OMNILEADS_IP>`).
6. Note also your account SID and Auth Token- you would need them to configure OmniLeads

### Configure OMniLeads to use Twilio

1. Go to OmniLeads web interface and log in as admin(the default credentials are usually provided after the installation).
2. Navigate to **SIP Trunks** and create a new trunk with the **Twilio** credentials.
3. Configure the trunk by entering the Twilio **Account SID**, **Auth Token**, and the **Termination SIP URI** you set up earlier.

## Network and Security settings

### Configure firewall

1. In the DigitalOcean dashboard, go to Networking > Firewalls
2. Create a new firewall:
- Allow SSH(Port 22), HTTP(Port 80), and HTTPS(Port 443)
- For Omnileads, open SIP ports(5060 and 5061)
- Apply the firewall to your droplets

### Set up SSL certification

1. Using Let‚Äôs Encrypt to secure the web interfaces with SSL
a. Install Certbot

```bash
sudo apt install certbot python3-certbot-nginx -y
```

         b. Generate SSL certificates for your domain

```bash
sudo certbot --nginx -d yourdomain.com -d www.yourdomain.com
```

## Basic Troubleshooting tips

1. If OMniLeads isn‚Äôt starting: check the Docker logs

```bash
docker logs <omni-container>
```

2. If Odoo won‚Äôt connect to the PostgreSQL: ensure the database and running effectively and is accessible

```bash
sudo systemctl status postgresql
```

## Backup and Maintenance

### Regular backups

1. Set up automatic backups using DigitalOcean‚Äôs snapshot feature for each droplet

### Database backups

1. For PostgreSQL:

```bash
pg_dump odoo_db > odoo_backup.sql
```

## Recommendation on how to set up the chatbot

Integrating an AI chatbot feature into your call center system can enhance customer service by automating routine inquiries, providing instant responses, and offering 24/7 support. The chatbot can work alongside the CRM (Odoo) to handle incoming messages and seamlessly escalate complex queries to human agents via OmniLeads. Below is a step-by-step guide to integrating an AI chatbot, with focus on using **Twilio Autopilot** (for communication via SMS, chat, or voice) or **Odoo Live Chat** (for web-based customer support). We'll also touch on using **Dialogflow** or **Rasa** for more advanced NLP (Natural Language Processing) capabilities.

### 1. **Overview of Chatbot Integration Components**

- **Twilio Autopilot**: AI chatbot that can handle voice and text interactions via SMS, WhatsApp, and Voice (for calls).
- **Dialogflow/Rasa**: NLP engines for more complex conversational AI.
- **Odoo Live Chat**: Native Odoo module for web-based customer chat.
- **OmniLeads Integration**: To route escalated calls or chats to live agents when needed.

---

### 2. **Choosing the Chatbot Platform**

- **Twilio Autopilot**: Ideal if you want to integrate the chatbot with voice or SMS systems. It natively integrates with Twilio‚Äôs SIP trunking and communications tools.
- **Dialogflow or Rasa**: These platforms offer more robust NLP capabilities, allowing you to create highly customized conversational bots that can integrate with Odoo for customer management and with Twilio for voice interactions.
- **Odoo Live Chat**: For simple, web-based chatbots that interact with customers through your website or Odoo CRM.

---

### 3. **Setting Up Twilio Autopilot (For Voice, SMS, and Chat)**

Twilio Autopilot is a ready-to-use solution for handling customer interactions over multiple channels, including voice, SMS, and chat. Here's how to integrate it into your call center system.

### Step 1: **Create a Twilio Autopilot Assistant**

1. Sign in to your Twilio account and navigate to **Autopilot** under the "AI & Automation" section.
2. Click "Create a New Assistant" and choose a template based on your use case (e.g., "Customer Support Bot").
3. Customize your assistant by adding **tasks** (actions the chatbot can perform, like "Check Order Status" or "Transfer to Agent").

### Step 2: **Connect Autopilot with Twilio's SIP Trunking and OmniLeads**

1. Go to the **Twilio SIP Trunk** that you created earlier and set it up to route incoming calls to the Autopilot bot.
2. In the Twilio console, under **SIP Trunking ‚Üí Trunks ‚Üí Voice** settings, set the "SIP URI" to the URL of your Twilio Autopilot assistant.
3. Configure Autopilot to transfer complex inquiries to human agents in OmniLeads. This is done using Twilio **TaskRouter**, which routes calls based on agent availability.
    
    For example, in your Autopilot task definition, include a `handoff` action like:
    
    ```json
    {
      "actions": [
        {
          "handoff": {
            "channel": "voice",
            "uri": "<https://your-omnileads-server.com/api/v1/calls>"
          }
        }
      ]
    }
    
    ```
    

### Step 3: **Configure Escalation to Live Agents (OmniLeads)**

- When Autopilot cannot handle a query, it needs to escalate to a human agent in OmniLeads. Set up a fallback **task** in Autopilot that triggers a handoff to OmniLeads.
- Create a fallback task like:
    
    ```json
    {
      "actions": [
        {
          "say": {
            "speech": "Let me connect you to an agent."
          }
        },
        {
          "handoff": {
            "channel": "voice",
            "uri": "<sip:agent@your-omnileads-server.com>"
          }
        }
      ]
    }
    
    ```
    

### Estimated Time: 1-2 hours

---

### 4. **Setting Up Dialogflow (For Advanced NLP) with Twilio and Odoo**

For a more advanced chatbot that uses **Natural Language Processing (NLP)**, you can integrate **Google Dialogflow** with your Twilio communications system and Odoo CRM.

### Step 1: **Create a Dialogflow Agent**

1. Sign up for **Google Dialogflow** at [dialogflow.cloud.google.com](https://dialogflow.cloud.google.com/).
2. Create a new **Agent** and configure intents (types of queries the bot can respond to) and entities (parameters it can extract from conversations).
    - Example intents: "Order Status", "Return Policy", "Talk to Human."

### Step 2: **Integrate Dialogflow with Twilio**

1. Navigate to Twilio's console and create a **Twilio Studio Flow** to route messages and calls through your Dialogflow agent.
2. In your Twilio Studio Flow, add a **Send to Dialogflow** widget to pass incoming messages or calls to Dialogflow for analysis.
3. For voice calls, create a webhook to forward calls from Twilio SIP trunk to Dialogflow via **Google Cloud Functions**.
    
    Example webhook setup in Twilio:
    
    ```json
    {
      "actions": [
        {
          "listen": {
            "service": "dialogflow",
            "uri": "<https://api.dialogflow.com/v1/query?v=20150910>"
          }
        }
      ]
    }
    
    ```
    

### Step 3: **Integrate Dialogflow with Odoo CRM**

1. Dialogflow can interact with Odoo CRM via webhook calls to trigger events like checking a customer‚Äôs order status or opening a support ticket.
2. Create webhooks in Dialogflow‚Äôs **Fulfillment** section that POST data to your Odoo API.
3. Example webhook payload:
Odoo will process the webhook and respond with the order status.
    
    ```json
    {
      "customer_id": "12345",
      "intent": "Check Order Status"
    }
    
    ```
    

### Estimated Time: 3-4 hours

---

### 5. **Integrating Odoo Live Chat (For Web-Based Support)**

If your call center also provides chat support via a website, you can use **Odoo Live Chat** to add a web-based chatbot for customer interactions.

### Step 1: **Enable Live Chat in Odoo**

1. Log into your Odoo CRM and go to **Apps**.
2. Search for and install the **Live Chat** module.
3. Configure the **Live Chat** channel under **Website ‚Üí Live Chat Channels**.
4. Create a script for the chatbot to respond to simple questions. You can also set triggers for complex queries to be escalated to a live agent.

### Step 2: **Customize Chatbot Responses**

1. In Odoo Live Chat, set up pre-configured responses for common queries (like business hours, FAQs).
2. Optionally, integrate an external NLP engine like **Rasa** or **Dialogflow** to improve chatbot interactions.

### Step 3: **Route Complex Queries to OmniLeads**

1. Create a trigger in Odoo Live Chat that forwards the conversation to a live agent if the chatbot can't handle the query.
2. Integrate the escalation with OmniLeads through API or SIP URI routing for voice or chat transfers.

### Estimated Time: 1-2 hours

---

### 6. **Security and SSL Setup for Chatbots**

For secure communication between Twilio, Dialogflow, and your servers, you need to set up SSL certificates. This was partially covered in the main setup, but here are some additional tips:

- For **Twilio** webhook integrations, make sure you use HTTPS endpoints.
- For **Dialogflow webhooks** and Odoo API connections, enable SSL using **Certbot**.

---

### 7. **Basic Troubleshooting for Chatbot Integration**

- **Twilio Chatbot Fails to Respond**: Check your Twilio Studio logs for errors in routing or webhook calls.
- **Dialogflow Not Understanding Queries**: Ensure that intents and entities are correctly configured in Dialogflow, and check for misconfigured fulfillment endpoints.
- **Odoo Live Chat Bot Not Working**: Double-check that the Live Chat module is active and the conversation script is properly configured.

---

### 8. **Maintenance and Backup Recommendations**

- Back up **Twilio Studio Flows** and Autopilot configurations regularly.
- Back up **Dialogflow** agents by exporting their configurations from the Dialogflow console.
- Schedule regular backups for your **Odoo** CRM system and make sure the chat logs are saved for later analysis.

---

### **Conclusion**

Adding an AI chatbot feature to your call center system significantly improves efficiency and customer satisfaction. Depending on your needs, you can choose between Twilio Autopilot, Dialogflow, or Odoo Live Chat. Each offers a different set of features for web chat, SMS, and voice support. This integration should take about 6-8 hours, and you'll have a robust AI-enhanced call center setup ready to handle customer inquiries!